function [ KMX ] = KMX_MIX( molefrac )
%UNTITLED6 此处显示有关此函数的摘要
%   此处显示详细说明


KMX20=[0.0896 0 0 0 0;
0.104283644	0.096050386	0.103328713	0	0;
0.11389109	0.102889114	0.107486027	0.124533831	0;
0.11995069	0.105126829	0.10861848	0.124693622	0.142820334;
0.124389837	0.105954692	0.107950809	0.118775102	0.135996685;
0.127863347	0.105273853	0.108306121	0.116485305	0.131336968;
0.130880823	0.10382558	0.106572321	0.117167724	0.127244396;
0.132878188	0.103473015	0.105710862	0.11718161	0.125241027;
0.134729125	0.10322459	0.10499636	0.111119216	0.124308009;
0.1364	0.1021 0 0 0];%单位为W/(m・K)
MW=[44.0956 1 1 1 1;
58.12	58.12	56.1063	1	1;
72.15	72.15	70.1329	70.13	1;
86.17	86.17	84.1595	84.16	78.11;
100.2	100.2	98.1861	98.18	92.14;
114.2	114.2	112.2123	112.2	106.1;
128.2	128.2	126.239	126.2	120.1;
142.2	142.2	140.266	140.2	134.2;
156.3	156.3	154.292	154.2	148.2;
170.335 170.335 1 1 1];

dens20=[493 1 1 1 1;
573.5	551	588	1	1;
626.2	620.1	643.625	745.7	1;
659.4	659.8	678.05	778.4	876.5;
683.7	688.296	698.02	768	866.7;
702.7	704.6	721.995	776.5	864.4;
719.2	713.497	729.8	802.3	861.5;
730.1	728.1	741.525	821.9	869.7;
740.2	742.2	752.714	796.5	883;
749.5 748.5 1 1 1];
dens=dens20./1000;
V2=MW./dens;%摩尔体积，单位为cuft/ibmol

molefrac1=conv_mat2_to_mat1( molefrac );

KMX2=KMX20.*0.672./1.16;%将单位换成Btu/(ft・h・H)
k=conv_mat2_to_mat1( KMX2 );
V1=conv_mat2_to_mat1( V2 );
fai1=molefrac1.*V1./(sum(sum(molefrac1.*V1)));

[m,n]=size(k);
K=zeros(50,50);
for i=1:n
    for j=1:n
      K(i,j)=((k(i))^(-1)+(k(j))^(-1))^(-1)*2;
    end
end
sum0=0;
for i=1:n
    for j=1:n
        sum0=sum0+fai1(i)*fai1(j)*K(i,j);
    end
end
KMX=sum0*1.16/0.672;
        

end

